<h1>Databases and data store</h1>
<h2>Slides</h2>
<p><a href="https://marko-knoebl.github.io/slides/">https://marko-knoebl.github.io/slides/</a></p>
<h2>Your Trainer</h2>
<p>Marko Kn√∂bl</p>
<ul>
<li>based in Vienna</li>
<li>former math teacher</li>
<li>programming topics:
<ul>
<li>JavaScript, TypeScript and React</li>
<li>Python, data science</li>
</ul>
</li>
</ul>
<h2>Introduction of Participants</h2>
<ul>
<li>current projects</li>
<li>prior knowledge</li>
<li>expectations</li>
</ul>
<h2>Organizational</h2>
<ul>
<li>duration</li>
<li>breaks</li>
<li>lunch</li>
<li>materials</li>
<li>questions, feedback?</li>
</ul>
<h2>Code</h2>
<p>Code available at: <a href="https://github.com/marko-knoebl/courses-code">https://github.com/marko-knoebl/courses-code</a></p>
<h1>Agenda</h1>
<ul>
<li>data formats</li>
<li>databases</li>
<li>SQL query language</li>
</ul>
<h1>Data formats</h1>
<h2>Data formats</h2>
<p>Important formats for saving / exchanging data:</p>
<ul>
<li>CSV (comma-separated values, text-based tabular documents)</li>
<li>JSON (JavaScript Object Notation)</li>
<li>XML (Extensible Markup Language, similar to HTML)</li>
<li>SQL databases</li>
<li>other databases</li>
</ul>
<h1>Data types</h1>
<h2>Data types</h2>
<p>Data types and data structures that are important in IT:</p>
<ul>
<li>numbers (integers and non-integers)</li>
<li>yes/no values</li>
<li>text</li>
<li>binary data (sequences of 0 and 1 that can represent arbitrary information - e.g. images, video, text, ...)</li>
<li>time and date</li>
<li>sequences of other data (e.g. a sequence of numbers)</li>
<li>associative arrays (key-value mappings)</li>
<li>missing data - often represented as <em>null</em></li>
</ul>
<h2>Example online data sources</h2>
<ul>
<li>DataHub: <a href="https://datahub.io/core">Core Data</a></li>
<li>OpenWeatherMap: <a href="https://samples.openweathermap.org/data/2.5/weather?q=Berlin&#x26;appid=b6907d289e10d714a6e88b30761fae22">example data (not live)</a></li>
</ul>
<h1>Numbers</h1>
<h2>Numbers</h2>
<p>types of numbers:</p>
<ul>
<li><em>integer</em></li>
<li><em>floating-point number</em> or <em>float</em> (binary system)</li>
<li><em>decimal</em></li>
</ul>
<h2>Numbers</h2>
<p>Programming languages commonly use <em>integers</em> and <em>floats</em></p>
<p>Databases and some data formats additionally use <em>decimals</em></p>
<h2>Numbers</h2>
<p>Be cautious of rounding errors: Some numbers cannot be represented as floating point numbers - the will always be rounded</p>
<p>e.g.: <code>1/3</code></p>
<p>A computer is also unable to represent numbers like <code>0.1</code> or <code>0.2</code> exactly</p>
<p>Example: <code>0.3 - 0.2</code> will often not evaluate to <code>0.1</code>, but <code>0.09999999999999998</code></p>
<h2>Numbers</h2>
<p>Types like <em>integer</em> or <em>float</em> usually have a specific accuracy</p>
<p>examples:</p>
<ul>
<li>an <em>integer</em> in <em>SQL</em> can typically represent the values <em>-2,147,483,648</em> to <em>2,147,483,647</em></li>
<li>a binary floating point number often has an accuracy of about 15 decimal places (<em>64-Bit numbers</em>)</li>
</ul>
<h2>Numbers</h2>
<p>Saving as a number or as text?</p>
<p>How should we store credit card numbers, ZIP codes, telephone numbers, ...</p>
<h2>Numbers</h2>
<p>Credit card numbers, ZIP codes, telephone numbers should be stored as text</p>
<p>reasons:</p>
<ul>
<li>these numbers can start with zeros</li>
<li>these numbers can include special characters (e.g. <code>/</code>, spaces)</li>
</ul>
<p>Principle: if a number cannot be sensibly used for coputations it should be stored as text</p>
<h1>Boolean values</h1>
<h2>Boolean values</h2>
<p>Boolean value = value representing yes/no or true/false</p>
<p>Boolean values can be represented via a separate data type or via the values <code>1</code> and <code>0</code></p>
<p>Are usually named <code>true</code> and <code>false</code></p>
<h1>Strings</h1>
<h2>Strings</h2>
<p>A <em>string</em> represents text</p>
<p>Today strings can <em>mostly</em> include all Unicode characters; in some cases the character set will be limited, e.g. to <em>ASCII</em></p>
<h2>Strings</h2>
<p>Strings are usually delimited by single or double quotes</p>
<p>Valid string literal in Python, JavaScript, JSON:</p>
<pre><code class="hljs language-txt">"Hello, world!"
</code></pre>
<p>String in Python, JavaScript, SQL:</p>
<pre><code class="hljs language-txt">'Hello, world!'
</code></pre>
<h2>Strings - escape sequences</h2>
<p>Problem: how do we write characters like <code>"</code> inside of a string?</p>
<p>invalid:</p>
<pre><code class="hljs language-py"><span class="hljs-string">"He said: "</span>hi!<span class="hljs-string">""</span>
</code></pre>
<h2>Strings - escape sequences</h2>
<p>Solution in Python, JavaScript, JSON:</p>
<pre><code class="hljs language-JSON"><span class="hljs-string">"He said: \"hi!\""</span>
</code></pre>
<p>The character sequence <code>\"</code> is treated like a single quotation mark</p>
<p>Solution in CSV (and similarly in SQL):</p>
<pre><code class="hljs language-1c"><span class="hljs-string">"He said: ""hi!"""</span>
</code></pre>
<p>The character sequence <code>""</code> is treated like a single quotation mark</p>
<h2>Strings - escape sequences</h2>
<p>More escape sequences in programming languages:</p>
<p>Including a line break in a line (Linux, Mac):</p>
<pre><code class="hljs language-json"><span class="hljs-string">"line 1\nline 2"</span>
</code></pre>
<p>Including a line break in a line (Windows):</p>
<pre><code class="hljs language-json"><span class="hljs-string">"line 1\r\nline 2"</span>
</code></pre>
<p>Including a single backslash:</p>
<pre><code class="hljs language-json"><span class="hljs-string">"C:\\programs\\firefox"</span>
</code></pre>
<h1>null</h1>
<h2>null</h2>
<p>The special value <code>null</code> commonly represents missing / unknown data</p>
<h1>CSV</h1>
<h2>CSV</h2>
<p>CSV (<em>comma-separated values</em>) is a text file format which can hold tabular data</p>
<h2>Example</h2>
<pre><code class="hljs language-csv">ISO,Country,Capital,Languages
AD,Andorra,Andorra la Vella,"ES,FR"
AE,United Arab Emirates,Abu Dhabi,"AE,fa,en,hi,ur"
AF,Afghanistan,Kabul,"AF,tk"
</code></pre>
<h2>Standardization</h2>
<p>There is no official definitive standard</p>
<p>CSV formats can vary based on:</p>
<ul>
<li>separation character: could be a comma, semicolon, tab</li>
<li>presence of table header</li>
<li>rules for quoting and escaping values</li>
</ul>
<h2>Standardization</h2>
<p>The format is older than the standards - in practice the format varies widely</p>
<ul>
<li>RFC 4180: <a href="https://tools.ietf.org/html/rfc4180">https://tools.ietf.org/html/rfc4180</a></li>
<li>W3C: <a href="https://www.w3.org/TR/2015/REC-tabular-data-model-20151217/">https://www.w3.org/TR/2015/REC-tabular-data-model-20151217/</a>
<ul>
<li>includes <em>Best Practice CSV</em></li>
</ul>
</li>
</ul>
<h2>Standardization</h2>
<ul>
<li>First line <em>can</em> (RFC) / <em>should</em> (W3C) be a comma-separated list of column names</li>
<li>Lines <em>must</em> (RFC) / <em>should</em> (W3C) be separated by CRLF (carriage return &#x26; line feed)</li>
<li>Fields may be enclosed in double quotes; this is necessary if a field contains a comma, a double quote or a line break</li>
<li>If a double quote (<code>"</code>) appears within a field, it must be escaped by doubling it (<code>""</code>)</li>
</ul>
<h2>TSV</h2>
<p>Derived from CSV: <em>tab-separated values</em></p>
<p>Advantages: easier to read, commas don't have to be escaped</p>
<p>Disadvantages: not standardized, not as popular</p>
<pre><code class="hljs language-tsv">ISO	Country	Capital	Languages
AD	Andorra	Andorra la Vella	ES,FR
AE	United Arab Emirates	Abu Dhabi	AE,fa,en,hi,ur
AF	Afghanistan	Kabul	AF,tk
</code></pre>
<h2>Exercise</h2>
<p>Create a simple CSV file in VS Code and view it in tabular view (icon <em>open in preview</em> in the top right corner)</p>
<h1>JSON</h1>
<h2>JSON</h2>
<p>JSON = <em>JavaScript Object Notation</em>: File format which is especially relevant in web development.</p>
<h2>Data types</h2>
<ul>
<li>Number</li>
<li>String</li>
<li>Boolean</li>
<li>Null</li>
<li>Array</li>
<li>Object</li>
</ul>
<h2>Null</h2>
<p>The expression <code>null</code> symbolizes the absence of a value</p>
<pre><code class="hljs language-json"><span class="hljs-literal">null</span>
</code></pre>
<h2>String</h2>
<p>Strings are delimited by double quotes</p>
<p>(In JavaScript single quotes would be allowed as well)</p>
<h2>Array</h2>
<p>An <em>array</em> contains a sequence of other objects</p>
<pre><code class="hljs language-json">[<span class="hljs-string">"Anne"</span>, <span class="hljs-string">"Bob"</span>, <span class="hljs-string">"Chris"</span>]
</code></pre>
<pre><code class="hljs language-json">[<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>]
</code></pre>
<h2>Object</h2>
<p>An <em>object</em> contains named entries</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"firstName"</span>: <span class="hljs-string">"Thomas"</span>,
  <span class="hljs-attr">"lastName"</span>: <span class="hljs-string">"Edison"</span>,
  <span class="hljs-attr">"birthYear"</span>: <span class="hljs-number">1847</span>,
  <span class="hljs-attr">"living"</span>: <span class="hljs-literal">false</span>
}
</code></pre>
<p>(In JavaScript the names of entries can be stated without quotes, e.g. <code>firstName</code>)</p>
<h1>XML</h1>
<h2>XML</h2>
<p>XML = Extensible Markup Language</p>
<p>Language that is similar to HTML</p>
<p>Was a default language for data exchange; is being replaced more and more by JSON</p>
<h2>XML</h2>
<p>example:</p>
<pre><code class="hljs language-xml"><span class="hljs-tag">&#x3C;<span class="hljs-name">person</span>></span>
  <span class="hljs-tag">&#x3C;<span class="hljs-name">name</span>></span>Adam<span class="hljs-tag">&#x3C;/<span class="hljs-name">name</span>></span>
  <span class="hljs-tag">&#x3C;<span class="hljs-name">age</span> <span class="hljs-attr">unit</span>=<span class="hljs-string">"years"</span>></span>40<span class="hljs-tag">&#x3C;/<span class="hljs-name">age</span>></span>
<span class="hljs-tag">&#x3C;/<span class="hljs-name">person</span>></span>
</code></pre>
<h1>Databases</h1>
<h2>Databases</h2>
<p>use: managing big amounts of data</p>
<h2>Databases</h2>
<p>examples:</p>
<ul>
<li>SQL databases
<ul>
<li>MySQL</li>
<li>PostgreSQL</li>
<li>Microsoft SQL Server</li>
<li>SQLite</li>
<li>Oracle</li>
</ul>
</li>
<li>MongoDB</li>
<li>Redis</li>
</ul>
<p><a href="https://insights.stackoverflow.com/survey/2019#technology-_-databases">Popularity according to Stack Overflow Developer Survey 2019</a></p>
<h2>Terminology</h2>
<ul>
<li><strong>table / collection</strong>: a set of similar data objects (e.g. one for products)</li>
<li><strong>row / record / document</strong>: an entry in a table (e.g. a single product)</li>
<li><strong>field</strong>: a property of a record (e.g. <em>price</em>)</li>
</ul>
<h2>CRUD operations</h2>
<p>basic operations for database records:</p>
<ul>
<li><strong>c</strong>reate</li>
<li><strong>r</strong>ead / <strong>r</strong>etrieve</li>
<li><strong>u</strong>pdate</li>
<li><strong>d</strong>elete</li>
</ul>
<h2>Create</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> product (<span class="hljs-keyword">name</span>, <span class="hljs-keyword">category</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'IPhone'</span>, <span class="hljs-string">'electronics'</span>);
</code></pre>
<p>MongoDB shell:</p>
<pre><code class="hljs language-js">db.products.insertOne({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'IPhone'</span>,
  <span class="hljs-attr">category</span>: <span class="hljs-string">'electronics'</span>,
});
</code></pre>
<h2>Read</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, <span class="hljs-keyword">category</span> <span class="hljs-keyword">FROM</span> product
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">category</span> = <span class="hljs-string">'electronics'</span>;
</code></pre>
<p>MongoDB shell:</p>
<pre><code class="hljs language-js">db.products.find({ <span class="hljs-attr">category</span>: <span class="hljs-string">'electronics'</span> });
</code></pre>
<h2>Update</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">UPDATE</span> product
<span class="hljs-keyword">SET</span> <span class="hljs-keyword">category</span> = <span class="hljs-string">'phones'</span>
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'IPhone'</span>;
</code></pre>
<p>MongoDB shell:</p>
<pre><code class="hljs language-js">db.products.updateOne(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'IPhone'</span> },
  { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">category</span>: <span class="hljs-string">'phones'</span> } }
);
</code></pre>
<h2>Delete</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> product
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'IPhone'</span>;
</code></pre>
<p>MongoDB shell:</p>
<pre><code class="hljs language-js">db.products.deleteOne({ <span class="hljs-attr">name</span>: <span class="hljs-string">'IPhone'</span> });
</code></pre>
<h2>Online playgrounds</h2>
<ul>
<li><a href="https://www.w3schools.com/sql/trysql.asp?filename=trysql_select_all">SQL Editor from W3Schools</a> (contains predefined data, usable on Chrome and Safari)</li>
<li><a href="https://docs.mongodb.com/manual/tutorial/getting-started/">MongoDB Web Shell</a></li>
</ul>
<h2>Exercise</h2>
<p>Create / change / query data in an online playground</p>
<h1>SQL vs MongoDB</h1>
<h2>SQL vs MongoDB</h2>
<p>SQL (Structured Query Language): developed in the 1970s, many variants</p>
<p>MongoDB: released in 2009</p>
<h2>SQL vs MongoDB</h2>
<p>SQL: entries are stored in tables with predefined field names and field types (database schema)</p>
<p>MongoDB: entries (documents) in a collection may generally have arbitrary fields; a schema <em>may</em> be defined</p>
<h2>SQL vs MongoDB</h2>
<p>SQL: standardized language (in theory), independent of any programming language</p>
<p>MongoDB: direct bindings for programming languages</p>
<h1>MongoDB basics</h1>
<h2>MongoDB shell</h2>
<p><strong>MongoDB shell</strong> = simple command line interface for MongoDB that comes with MongoDB</p>
<p>try it online:</p>
<p><a href="https://docs.mongodb.com/manual/tutorial/getting-started/">https://docs.mongodb.com/manual/tutorial/getting-started/</a></p>
<p>use a subset of MongoDB shell in pure JavaScript (without installing MongoDB):</p>
<p><a href="https://github.com/marko-knoebl/mingodb">https://github.com/marko-knoebl/mingodb</a></p>
<h2>data types</h2>
<ul>
<li>numbers
<ul>
<li>int (32 bit) / long (64 bit)</li>
<li>double (64 bit floating point)</li>
<li>decimal (128 bit)</li>
</ul>
</li>
<li>bool</li>
<li>string</li>
<li>binData</li>
<li>date (date + time)</li>
<li>array</li>
<li>object</li>
<li>null</li>
<li>objectId</li>
</ul>
<p>see: <a href="https://docs.mongodb.com/manual/reference/bson-types/">https://docs.mongodb.com/manual/reference/bson-types/</a></p>
<h2>ids</h2>
<p>entries automatically get a unique <code>_id</code> field:</p>
<pre><code class="hljs language-js">entry = {
  <span class="hljs-attr">_id</span>: ObjectId(<span class="hljs-string">'5e715e1b31315b0be066db84'</span>),
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Argentina'</span>,
  <span class="hljs-attr">continent</span>: <span class="hljs-string">'South America'</span>,
};
</code></pre>
<h2>Create</h2>
<p>creating entries in a collection:</p>
<pre><code class="hljs language-js">db.countries.insertOne({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Argentina'</span>,
  <span class="hljs-attr">continent</span>: <span class="hljs-string">'South America'</span>,
});
</code></pre>
<h2>Create</h2>
<p>creating multiple entries at once:</p>
<pre><code class="hljs language-js">db.countries.insertMany([
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Finland'</span>, <span class="hljs-attr">continent</span>: <span class="hljs-string">'Europe'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Greece'</span>, <span class="hljs-attr">continent</span>: <span class="hljs-string">'Europe'</span> },
]);
</code></pre>
<h2>Read</h2>
<p>reading an array of all entries:</p>
<pre><code class="hljs language-js">db.countries.find();
</code></pre>
<p>only query for some specific entries:</p>
<pre><code class="hljs language-js">db.countries.find({ <span class="hljs-attr">continent</span>: <span class="hljs-string">'Europe'</span> });
</code></pre>
<h2>Read</h2>
<p>reading a single entry via <code>findOne</code>:</p>
<pre><code class="hljs language-js">db.countries.findOne({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Greece'</span> });
</code></pre>
<h2>Update</h2>
<p>changing an entry by setting its population:</p>
<pre><code class="hljs language-js">db.countries.updateOne(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Argentina'</span> },
  { <span class="hljs-attr">$set</span>: { <span class="hljs-attr">population</span>: <span class="hljs-number">44</span> } }
);
</code></pre>
<h2>Update</h2>
<p>replacing an entry:</p>
<pre><code class="hljs language-js">db.countries.replaceOne(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Brazil'</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Brazil'</span>, <span class="hljs-attr">population</span>: <span class="hljs-number">210</span> }
);
</code></pre>
<h2>Delete</h2>
<p>deleting an entry:</p>
<pre><code class="hljs language-js">db.countries.deleteOne({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Finland'</span> });
</code></pre>
<p>deleting all entries:</p>
<pre><code class="hljs language-js">db.countries.deleteMany({});
</code></pre>
<h2>BSON file format</h2>
<p>MongoDB is based on the BSON file format. It resembles JSON, but it is a binary format and can be read and written more efficiently</p>
<p>Importing and exporting can be done via the programs <code>mongodump</code> and <code>mongorestore</code></p>
<h2>Exercise</h2>
<p>Create and modify a contact database</p>
<h1>SQL Basics</h1>
<h2>SQL</h2>
<p>SQL = Structured Query Language</p>
<p>Standardized query language for tabular data</p>
<h2>SQL standardization</h2>
<p>The standard is newer than most implementations</p>
<p>Standardized by <em>ANSI</em> and <em>ISO</em></p>
<p>Old drafts of the standard (free):</p>
<ul>
<li><a href="http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt">SQL 1992 draft (txt, 1.5 MB)</a></li>
<li><a href="www.wiscorp.com/sql20nn.zip">SQL 2011 draft (zip of PDFs, 13 MB)</a></li>
</ul>
<h2>SQL implementations</h2>
<p>open source:</p>
<ul>
<li>MySQL</li>
<li>MariaDB</li>
<li>PostgreSQL</li>
<li>SQLite</li>
</ul>
<p>proprietary:</p>
<ul>
<li>Oracle</li>
<li>SQL Server (Microsoft)</li>
</ul>
<p><a href="https://insights.stackoverflow.com/survey/2019#technology-_-databases">Popularity according to Stackoverflow Developer Survey</a></p>
<h2>Trying SQL</h2>
<p><a href="https://db-fiddle.com">https://db-fiddle.com</a> (PostgreSQL, MySQL, SQLite)</p>
<p><a href="https://www.w3schools.com/sql/trysql.asp?filename=trysql_select_all">https://www.w3schools.com/sql/trysql.asp?filename=trysql_select_all</a> (SQLite)</p>
<p>Desktop application:</p>
<p><a href="https://sqlitebrowser.org/">https://sqlitebrowser.org/</a> (SQLite)</p>
<h2>General SQL syntax</h2>
<p>SQL statements are terminated by <code>;</code></p>
<p>Two variants of comments:</p>
<pre><code class="hljs language-sql"><span class="hljs-comment">/* multi-line
comment */</span>
</code></pre>
<pre><code class="hljs language-sql"><span class="hljs-comment">-- single line comment</span>
</code></pre>
<h2>General SQL syntax</h2>
<p>SQL is motly <em>case insensitive</em></p>
<p>Convention: keywords capitalized, rest lowercase and separated by underscores</p>
<p>example:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> first_name, last_name, tel <span class="hljs-keyword">FROM</span> person;
</code></pre>
<h2>General SQL syntax</h2>
<p>Table names and column names are converted to uppercase by SQL, e.g. <code>first_name</code> ‚Üí <code>FIRST_NAME</code>, <code>person</code> ‚Üí <code>PERSON</code></p>
<p>Exceptions: In <em>PostgreSQL</em> names are converted to lowercase</p>
<h2>General SQL syntax</h2>
<p>If names should be used in their exact spelling they need to be quoted; this is rather uncommon</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-string">"First_Name"</span>, <span class="hljs-string">"Last_Name"</span>, <span class="hljs-string">"Tel"</span> <span class="hljs-keyword">FROM</span> <span class="hljs-string">"Person"</span>;
</code></pre>
<p>Exception: In <em>MySQL</em> would use backticks (`) in place of quotes; the mode <code>ANSI_QUOTES</code> can be enabled for standards compliant behavior</p>
<h2>Exercise data</h2>
<p><a href="https://github.com/datasets">https://github.com/datasets</a></p>
<h2>Creating tables</h2>
<p>command: <code>CREATE TABLE</code></p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> person(
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">50</span>),
    tel <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>)
);
</code></pre>
<h2>SQL data types</h2>
<p>ISO / ANSI SQL Standard (selection):</p>
<ul>
<li><code>BOOLEAN</code></li>
<li><code>INT</code> / <code>INTEGER</code>, <code>SMALLINT</code>, <code>BIGINT</code></li>
<li><code>NUMERIC</code> / <code>DECIMAL</code></li>
<li><code>REAL</code>, <code>DOUBLE PRECISION</code></li>
<li><code>VARCHAR(n)</code></li>
<li><code>VARBINARY(n)</code></li>
<li><code>DATE</code>, <code>TIME</code>, <code>TIMESTAMP</code></li>
</ul>
<h2>Inserting data</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> person (<span class="hljs-keyword">name</span>, tel)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'John Smith'</span>, <span class="hljs-string">'012345'</span>);
</code></pre>
<p>short form:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> person
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'John Smith'</span>, <span class="hljs-string">'012345'</span>);
</code></pre>
<h2>Querying data</h2>
<p>Querying data of all persons:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">name</span>, tel <span class="hljs-keyword">FROM</span> person;
</code></pre>
<p>or</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> person;
</code></pre>
<h2>Conditional queries (WHERE)</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> tel
<span class="hljs-keyword">FROM</span> person
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'John Smith'</span>;
</code></pre>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> tel
<span class="hljs-keyword">FROM</span> person
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'% Smith'</span>
<span class="hljs-keyword">AND</span> tel <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'+49%'</span>;
</code></pre>
<h2>Modifying data (UPDATE)</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">UPDATE</span> person
<span class="hljs-keyword">SET</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'John Miller'</span>
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'John Smith'</span>;
</code></pre>
<h2>Deleting data (DELETE)</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> person
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span> = <span class="hljs-string">'John Miller'</span>;
</code></pre>
<h2>Exercise</h2>
<p>Create and modify a contact database</p>
<h1>MongoDB schema</h1>
<h2>MongoDB schema</h2>
<p>validation via JSON schema, e.g.:</p>
<pre><code class="hljs language-js"><span class="hljs-keyword">const</span> elementSchema = {
  <span class="hljs-attr">bsonType</span>: <span class="hljs-string">'object'</span>,
  <span class="hljs-attr">required</span>: [
    <span class="hljs-string">'atomic_number'</span>,
    <span class="hljs-string">'symbol'</span>,
    <span class="hljs-string">'name'</span>,
    <span class="hljs-string">'atomic_mass'</span>,
  ],
  <span class="hljs-attr">properties</span>: {
    <span class="hljs-attr">atomic_number</span>: {
      <span class="hljs-attr">bsonType</span>: <span class="hljs-string">'int'</span>,
      <span class="hljs-attr">minimum</span>: <span class="hljs-number">1</span>,
    },
    <span class="hljs-attr">symbol</span>: {
      <span class="hljs-attr">bsonType</span>: <span class="hljs-string">'string'</span>,
    },
    <span class="hljs-attr">name</span>: {
      <span class="hljs-attr">bsonType</span>: <span class="hljs-string">'string'</span>,
    },
    <span class="hljs-attr">atomic_mass</span>: {
      <span class="hljs-attr">bsonType</span>: <span class="hljs-string">'double'</span>,
    },
  },
};
</code></pre>
<h2>MongoDB schema</h2>
<pre><code class="hljs language-js">db.createCollection(<span class="hljs-string">'elements'</span>, {
  <span class="hljs-attr">validator</span>: { <span class="hljs-attr">$jsonSchema</span>: elementSchema },
});
</code></pre>
<h1>SQL schema and indexes</h1>
<h2>Online Tutorial</h2>
<p><a href="https://www.w3schools.com/sql/default.asp">https://www.w3schools.com/sql/default.asp</a></p>
<h2>Recap: SQL data types</h2>
<p>ISO / ANSI SQL Standard (selection):</p>
<ul>
<li><code>BOOLEAN</code></li>
<li><code>INT</code> / <code>INTEGER</code>, <code>SMALLINT</code>, <code>BIGINT</code></li>
<li><code>REAL</code>, <code>DOUBLE PRECISION</code></li>
<li><code>VARCHAR(n)</code></li>
<li><code>VARBINARY(n)</code></li>
<li><code>DATE</code>, <code>TIME</code>, <code>TIMESTAMP</code></li>
</ul>
<h2>Boolean</h2>
<p>Represented by the expressions <code>TRUE</code> and <code>FALSE</code></p>
<p>Deviations from the standard:</p>
<ul>
<li><em>SQL Server</em>: <code>BOOLEAN</code> ‚Üí <code>BIT</code></li>
<li><em>MySQL</em>, <em>SQLite</em>, <em>Oracle</em>: not supported, alternative could be <code>0</code> and <code>1</code></li>
</ul>
<h2>Numbers</h2>
<ul>
<li><code>SMALLINT</code> (commonly 16 Bit)</li>
<li><code>INT</code> / <code>INTEGER</code> (commonly 32 Bit)</li>
<li><code>BIGINT</code> (commonly 64 Bit)</li>
<li><code>NUMERIC</code> / <code>DECIMAL</code> (decimal numbers with variable accuracy)</li>
<li><code>REAL</code> (commonly 32 Bit)</li>
<li><code>DOUBLE PRECISION</code> (commonly 64 Bit)</li>
</ul>
<p>Deviations from the standard:</p>
<ul>
<li><em>MySQL</em>: <code>REAL</code> ‚Üí <code>FLOAT</code></li>
<li><em>SQLite</em>: All types are stored with 64 bit accuracy</li>
</ul>
<h2>Numbers</h2>
<p>Decimal number with 10 digits before and 2 digits after the decimal point:</p>
<pre><code class="hljs language-sql">DECIMAL(12, 2)
</code></pre>
<h2>Numbers</h2>
<p>MySQL distinguishes between:</p>
<ul>
<li><code>SMALLINT</code> (-32768 to 32767)</li>
<li><code>UNSIGNED SMALLINT</code> (0 to 65535)</li>
</ul>
<h2>Text</h2>
<ul>
<li><code>VARCHAR(10)</code>: Text of up to 10 characters</li>
</ul>
<p>Usually Unicode is supported</p>
<p>On <em>SQL Server</em>: Use <code>NVARCHAR</code> for Unicode support (needs twice as much space)</p>
<p>On <em>Oracle</em>: use <code>VARCHAR2</code></p>
<p>Maximum length does not affect size on disk (but may affect size in memory)</p>
<h2>Text</h2>
<p>Text is <em>always</em> delimited by single quotes:</p>
<pre><code class="hljs language-SQL"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">test</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Hello'</span>);
</code></pre>
<p>Escaping quotes by doubling:</p>
<pre><code class="hljs language-SQL"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">test</span> <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Let''s go'</span>);
</code></pre>
<h2>Binary data</h2>
<p><code>VARBINARY(n)</code>: Byte sequence with maximum length <em>n</em></p>
<p>Deviations from the standard:</p>
<ul>
<li><em>PostgreSQL</em>: <code>BYTEA</code></li>
<li><em>SQLite</em>: Internally the data type is called <code>BLOB</code>, but <code>VARBINARY</code> is accepted</li>
</ul>
<h2>Date, Time</h2>
<p>Types:</p>
<ul>
<li><code>DATE</code></li>
<li><code>TIME</code></li>
<li><code>TIMESTAMP</code>: date and time</li>
</ul>
<p>examples:</p>
<ul>
<li><code>'2013-02-14'</code> (recommended format)</li>
<li><code>'13:02:17'</code>, <code>'13:02:17.232'</code></li>
<li><code>'2013-02-14 13:02:17'</code>, <code>'2013-02-14T13:02:17'</code></li>
</ul>
<h2>Date, Time</h2>
<p>Deviations from the standard:</p>
<ul>
<li>not supported by <code>SQLite</code></li>
<li><em>SQL Server</em>: <code>TIMESTAMP</code> ‚Üí <code>DATETIME</code></li>
</ul>
<p>Limitations:</p>
<ul>
<li><em>MySQL</em>: <code>TIMESTAMP</code> is limited to years between 1970 and 2038 - a better alternative would be <code>DATETIME</code></li>
</ul>
<h2>Resources on data types</h2>
<ul>
<li><a href="https://sqlite.org/datatype3.html">SQLite data types</a></li>
<li><a href="https://www.postgresql.org/docs/current/datatype.html">PostgreSQL data types</a></li>
<li><a href="https://www.postgresql.org/docs/current/features.html">PostgreSQL SQL Conformance</a></li>
</ul>
<h2>Example: database of chemical elements</h2>
<p>entries:</p>
<ul>
<li><em>atomic_number</em></li>
<li><em>symbol</em></li>
<li><em>name</em></li>
<li><em>atomic_mass</em></li>
</ul>
<h2>Example: database of chemical elements</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    atomic_number <span class="hljs-built_in">INT</span>,
    symbol <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">2</span>),
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>),
    atomic_mass <span class="hljs-built_in">REAL</span>
);
</code></pre>
<h2>Constraints</h2>
<p>Constraining columns:</p>
<ul>
<li><code>NOT NULL</code></li>
<li><code>UNIQUE</code></li>
<li><code>PRIMARY KEY</code></li>
<li>(<code>FOREIGN KEY</code>)</li>
</ul>
<h2>Not null</h2>
<p>Entry may not be left blank</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    atomic_number <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    symbol <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    atomic_mass <span class="hljs-built_in">REAL</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
);
</code></pre>
<h2>Unique</h2>
<p>Each entry in a column must be unique</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    atomic_number <span class="hljs-built_in">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    symbol <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    atomic_mass <span class="hljs-built_in">REAL</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
);
</code></pre>
<h2>Primary key</h2>
<p>Enables a unique identification of a row in a table</p>
<ul>
<li>natural key: is "naturally" contained in the data</li>
<li>surrogate key: is added in addition to the data (as an integer)</li>
</ul>
<p>A primary key is always <em>unique</em> and <em>not null</em></p>
<h2>Primary key</h2>
<p>natural key:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    atomic_number <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span>,
    symbol <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    atomic_mass <span class="hljs-built_in">REAL</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
);
</code></pre>
<h2>Primary key</h2>
<p>surrogate key:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span>,
    atomic_numer <span class="hljs-built_in">INT</span>,
    symbol <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    atomic_mass <span class="hljs-built_in">REAL</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
);
</code></pre>
<h2>Auto increment</h2>
<p>Automatic creation of a numeric primary key starting at 1:</p>
<p>Standard SQL (implemented in PostgreSQL, Oracle):</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">IDENTITY</span>;
    ...
);
</code></pre>
<h2>Auto increment</h2>
<p>other variants:</p>
<ul>
<li>MySQL: <code>AUTO_INCREMENT</code></li>
<li>SQLite: <code>AUTOINCREMENT</code></li>
<li>PostgreSQL: <code>SERIAL</code></li>
</ul>
<p>SQLite will always automatically generate a unique numeric key under the name <code>rowid</code></p>
<h2>Indexes in databases</h2>
<p>In general: ordered lists can be searched much quicker than unordered lists (binary search)</p>
<p>Example: in the phone book we can quickly search for a last name, but not for a first name</p>
<p>Indexes may be added to one or more columns (additional data that references the entries in a specific order)</p>
<h2>Creating indexes</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_name
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">element</span> (<span class="hljs-keyword">name</span>);
</code></pre>
<p>Querying for names will now be faster</p>
<h2>Code: periodic table</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">element</span>(
    atomic_number <span class="hljs-built_in">INT</span>,
    symbol <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">2</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">UNIQUE</span>,
    atomic_mass <span class="hljs-built_in">REAL</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
);

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_name
<span class="hljs-keyword">ON</span> <span class="hljs-keyword">element</span> (<span class="hljs-keyword">name</span>);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">element</span>(atomic_number, symbol, <span class="hljs-keyword">name</span>, atomic_mass)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">'H'</span>, <span class="hljs-string">'Hydrogen'</span>, <span class="hljs-number">1.008</span>);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">element</span>(atomic_number, symbol, <span class="hljs-keyword">name</span>, atomic_mass)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">'He'</span>, <span class="hljs-string">'Helium'</span>, <span class="hljs-number">4.0026</span>);

<span class="hljs-keyword">SELECT</span> *
<span class="hljs-keyword">FROM</span> <span class="hljs-keyword">element</span>
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span>=<span class="hljs-string">'Hydrogen'</span>;
</code></pre>
<h1>SQL vs MongoDB 2</h1>
<h2>SQL vs MongoDB</h2>
<p>SQL: mostly scales vertically: adding resources to an existing server</p>
<p>MongoDB: mostly scales horizontally: adding additional servers (via sharding)</p>
<h2>SQL vs MongoDB</h2>
<p>SQL: mostly uses <em>atomic</em> entries (and first normal form)</p>
<p>MongoDB: often includes composite entries (arrays, objects):</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"sue"</span>,
  <span class="hljs-attr">"groups"</span>: [<span class="hljs-string">"news"</span>, <span class="hljs-string">"sports"</span>]
}
</code></pre>
<h1>Databases - intermediate</h1>
<h2>Relations between tables</h2>
<ul>
<li><code>1 : 1</code></li>
<li><code>1 : n</code></li>
<li><code>m : n</code></li>
</ul>
<h2>Relations between tables: examples</h2>
<ul>
<li><code>0..1 : 1..1</code><br />
department ‚Üêmanages‚Üí employee<br />
A department has 1 manager; each employee manages either 0 or 1 departments</li>
<li><code>0..1 : 0..n</code><br />
department ‚Üêworks in‚Üí employee<br />
A department can have many employees; an employee can be assigned to 0 or 1 departments;</li>
<li><code>0..m : 0..n</code><br />
project ‚Üêworks on‚Üí employee<br />
A project can have multiple employees working on it; an employee can work on multiple projects</li>
</ul>
<h2>Entity-relationship model</h2>
<p><a href="https://en.wikipedia.org/wiki/Entity%E2%80%93relationship_model">https://en.wikipedia.org/wiki/Entity%E2%80%93relationship_model</a></p>
<h2>ACID</h2>
<p>Properties of a database that guarantee its validity (protecting against errors):</p>
<ul>
<li><em>Atomicity</em>: Data are modified via transactions which either succeed or fail as a whole - a transaction is never applied only partially.</li>
<li><em>Consistency</em>: There may be constraints that are defined for datasets. A transaction that would violate such a constraint will fail and will not be applied.</li>
<li><em>Isolation</em>: Transactions that run in parallel will not influence each other.</li>
<li><em>Durability</em>: If a transaction is reported to have succeeded its result must be available permanently (i.e. not just in RAM).</li>
</ul>
<h1>SQL Joins</h1>
<h2>Example: music database</h2>
<p>tables:</p>
<ul>
<li><em>artist</em></li>
<li><em>album</em></li>
<li><em>song</em></li>
</ul>
<p>template: Chinook Musikdatenbank</p>
<p><a href="https://github.com/lerocha/chinook-database">GitHub</a></p>
<p><a href="http://schemaspy.org/sample/index.html">Inspector on SchemaSpy</a></p>
<h2>Example: music database - artist</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> artist(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">IDENTITY</span>,
    <span class="hljs-keyword">name</span> <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    country <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    <span class="hljs-keyword">year</span> <span class="hljs-built_in">SMALLINT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> artist (<span class="hljs-keyword">name</span>, country, <span class="hljs-keyword">year</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'The Beatles'</span>, <span class="hljs-string">'UK'</span>, <span class="hljs-number">1960</span>);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> artist (<span class="hljs-keyword">name</span>, country, <span class="hljs-keyword">year</span>)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'AC/DC'</span>, <span class="hljs-string">'AUS'</span>, <span class="hljs-number">1973</span>);
</code></pre>
<h2>Foreign key</h2>
<p>Reference to one entry in another table</p>
<p>example: each entry in the table <em>song</em> may reference an entry in the table <em>artist</em> via the column <em>artist_id</em></p>
<h2>Foreign key</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> song(
    <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span> PRIMARY <span class="hljs-keyword">KEY</span> <span class="hljs-keyword">GENERATED</span> <span class="hljs-keyword">ALWAYS</span> <span class="hljs-keyword">AS</span> <span class="hljs-keyword">IDENTITY</span>,
    title <span class="hljs-built_in">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>,
    artist_id <span class="hljs-built_in">INT</span>,
    <span class="hljs-keyword">FOREIGN</span> <span class="hljs-keyword">KEY</span>(artist_id) <span class="hljs-keyword">REFERENCES</span> artist(<span class="hljs-keyword">id</span>)
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> song (title, artist_id)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Let it Be'</span>, <span class="hljs-number">1</span>);
</code></pre>
<h2>Foreign key</h2>
<p>A foreign key guarantees the existence of a matching entry in the other associated table</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> song (title, artist_id)
<span class="hljs-keyword">VALUES</span> (<span class="hljs-string">'Wish You Were Here'</span>, <span class="hljs-number">10</span>);
</code></pre>
<p>‚Üí error</p>
<h2>Joining tables (INNER JOIN)</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> song.title, artist.name
<span class="hljs-keyword">FROM</span> artist
<span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> song
<span class="hljs-keyword">ON</span> artist.id=song.artist_id;
</code></pre>
<p>The above code lists all combinations where <code>artist.id</code> and <code>song.artist_id</code> match</p>
<h2>Joining tables (LEFT JOIN)</h2>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> song.title, artist.name
<span class="hljs-keyword">FROM</span> song
<span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> artist
<span class="hljs-keyword">ON</span> artist.id=song.artist_id;
</code></pre>
<p>The above code lists all combinations and also includes songs that don't have an artist defined</p>
<h1>Querying data - examples</h1>
<h2>Getting all data</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> iris;
</code></pre>
<p>SQLAlchemy (Python):</p>
<pre><code class="hljs language-sql">session.query(Iris)
</code></pre>
<p>mongo shell (JS):</p>
<pre><code class="hljs language-js">db.iris.find({});
</code></pre>
<p>Pandas (Python): N/A</p>
<h2>Selecting only some columns / fields</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> sepal_length, sepal_width <span class="hljs-keyword">FROM</span> iris;
</code></pre>
<p>SQLAlchemy (Python):</p>
<pre><code class="hljs language-sql">session.query(Iris.sepal_length, Iris.sepal_width)
</code></pre>
<h2>Selecting only some columns / fields</h2>
<p>Mongo shell:</p>
<pre><code class="hljs language-js">db.iris.find({}, { <span class="hljs-attr">sepal_length</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">sepal_width</span>: <span class="hljs-number">1</span> });
</code></pre>
<p>Pandas:</p>
<pre><code class="hljs language-py">iris_data.loc[:,[<span class="hljs-string">"sepal_length"</span>, <span class="hljs-string">"sepal_width"</span>]]
</code></pre>
<h2>Finding specific entries</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> iris <span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span>=<span class="hljs-string">'Iris-setosa'</span>;
</code></pre>
<p>SQLAlchemy (Python):</p>
<pre><code class="hljs language-py">session.query(Iris).<span class="hljs-built_in">filter</span>(Iris.name=<span class="hljs-string">"Iris-setosa"</span>)
</code></pre>
<h2>Finding specific entries</h2>
<p>mongo shell:</p>
<pre><code class="hljs language-js">db.iris.find({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Iris-setosa'</span> });
</code></pre>
<p>pandas (Python):</p>
<pre><code class="hljs language-py">iris_setosa_data = iris_data.loc[
    iris_data[<span class="hljs-string">"name"</span>] == <span class="hljs-string">"Iris-setosa"</span>
]
</code></pre>
<p>pandas (Python): selecting a range of rows:</p>
<pre><code class="hljs language-py">iris_data.iloc[<span class="hljs-number">10</span>:<span class="hljs-number">20</span>]
</code></pre>
<h2>Combination: rows and columns</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> sepal_length, sepal_width
<span class="hljs-keyword">FROM</span> iris
<span class="hljs-keyword">WHERE</span> <span class="hljs-keyword">name</span>=<span class="hljs-string">'Iris-setosa'</span>;
</code></pre>
<h2>Combination: rows and columns</h2>
<p>SQLAlchemy (Python):</p>
<pre><code class="hljs language-py">session.query(
    Iris.sepal_length, Iris.sepal_width
).<span class="hljs-built_in">filter</span>(Iris.name=<span class="hljs-string">"Iris-setosa"</span>)
</code></pre>
<h2>Combination: rows and columns</h2>
<p>mongo shell:</p>
<pre><code class="hljs language-js">db.iris.find(
  { <span class="hljs-attr">name</span>: <span class="hljs-string">'Iris-setosa'</span> },
  { <span class="hljs-attr">sepal_length</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">sepal_width</span>: <span class="hljs-number">1</span> }
);
</code></pre>
<h2>Combination: rows and columns</h2>
<p>pandas (Python):</p>
<pre><code class="hljs language-py">iris_data.loc[
    [iris_data[<span class="hljs-string">"name"</span>] == <span class="hljs-string">"Iris-setosa"</span>],
    [<span class="hljs-string">"sepal_length"</span>, <span class="hljs-string">"sepal_width"</span>],
]
</code></pre>
<h2>Sorting data</h2>
<p>SQL:</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> sepal_length, sepal_width
<span class="hljs-keyword">FROM</span> iris
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> sepal_length;
</code></pre>
<h2>Sorting data</h2>
<p>SQLAlchemy:</p>
<pre><code class="hljs language-py">session.query(
    Iris.sepal_length, Iris.sepal_width
).order_by(Iris.sepal_length)
</code></pre>
<h2>Sorting data</h2>
<p>mongo shell:</p>
<pre><code class="hljs language-js">db.iris
  .find({}, { <span class="hljs-attr">sepal_length</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">sepal_width</span>: <span class="hljs-number">1</span> })
  .sort({ <span class="hljs-attr">sepal_length</span>: <span class="hljs-number">1</span> });
</code></pre>
<h2>Sorting data</h2>
<p>pandas (Python):</p>
<pre><code class="hljs language-py">iris_data.loc[[<span class="hljs-string">"sepal_length"</span>, <span class="hljs-string">"sepal_width"</span>]].sort_values(
    by=<span class="hljs-string">"sepal_length"</span>
)
</code></pre>